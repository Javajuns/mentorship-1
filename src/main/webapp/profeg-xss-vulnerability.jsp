<%@ page import="com.github.javamentorship.mentorship.Profeg_DB" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>Try XSS vulnerability</title>
</head>
<body>

Пример скрипта для тестирования:<br/>
&lt;script&gt;alert('xss')&lt;/script&gt;<br/>

<br/>============================================<br/>
<form method="POST" action="profeg-xss-vulnerability.jsp">
    <% if ("on".equals(request.getParameter("protect")))
        out.println("<input type=\"checkbox\" name=\"protect\" value=\"on\" checked/>XSS Protect<br/>");
    else
        out.println("<input type=\"checkbox\" name=\"protect\" value=\"on\"/>XSS Protect<br/>");
    %>
    <textarea name="comment"></textarea><br/>
    <input type="submit" name="send" value="SendMessage"/>
    <input type="submit" name="clear" value="Clear"/>
</form>
<br/>============================================<br/>
<%
    if (request.getMethod().equals("POST")) {
        String comment = request.getParameter("comment");
        
        if("SendMessage".equals(request.getParameter("send")) && "on".equals(request.getParameter("protect"))) 
        {
            Profeg_DB.add_safe(comment);
        } else {
            Profeg_DB.comments.add(comment);
        }
        
        if("Clear".equals(request.getParameter("clear")))
        {
            Profeg_DB.comments.clear();
        }
    }
    
    for (String comment: Profeg_DB.comments) {
        if("on".equals(request.getParameter("protect"))) out.println(Profeg_DB.out_safe(comment) + "<br/>");
        else out.println(comment + "<br/>");
    }
%>

</body>
</html>
