<%@ page import="com.github.javamentorship.mentorship.DB" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>Try XSS vulnerability</title>
</head>
<body>

<div id="test">
Примеры скриптов для тестирования:<br/>
&lt;script&gt;alert('xss')&lt;/script&gt;<br/>
&lt;script&gt;function hack() {
    main_div=document.getElementById('test');
    main_div.innerHTML='YOU PAWNED!! ENOUGHT !1! NO MORE SCRIPTS HERE!!!11!';
    } hack(); &lt;/script&gt;
</div>
<br/>============================================<br/>
<form method="POST" action="profeg-xss-vulnerability.jsp">
    <textarea name="comment"></textarea><br/>
    <input type="submit" name="send" value="SendMessage"/>
    <input type="submit" name="clear" value="Clear"/>
</form>
<br/>============================================<br/>
<%
    if (request.getMethod().equals("POST")) {
        String comment = request.getParameter("comment");
        
        if("SendMessage".equals(request.getParameter("send")))
        {
            DB.comments.add(comment);
        }
        
        if("Clear".equals(request.getParameter("clear"))){
            DB.comments.clear();
        }
    }
    
    for (String comment: DB.comments) {
       out.println(DB.out_safe(comment) + "<br/>");
    }
%>

</body>
</html>
